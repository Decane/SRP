;-----------------------------------------------------------------------------------------;
;											  ;
; Experimental invulnerability fix by Decane! Inluded since SRP 0.7.2. Changed in v1.0.2. ;
;											  ;
;-----------------------------------------------------------------------------------------;

[logic]
active					= remark@wait
trade					= misc\trade\trade_trader_agr_stalker.ltx
level_spot				= trader

[remark@enemy]
path_walk				= agr_stalker_trader_walk
path_look				= agr_stalker_trader_look
out_restr				= agr_in_restr_stalker_trader
anim					= hands_up
target					= actor
meet					= no_meet
on_info					= {!gulag_enemy_actor(agr_smart_terrain_4_4)=smart_captured_by_faction(agr_smart_terrain_4_4:stalker)} remark@wait
combat_ignore_cond			= true
combat_ignore_keep_when_attacked	= true

[remark@invul_enemy]
invulnerable				= true
path_walk				= agr_stalker_trader_walk
path_look				= agr_stalker_trader_look
out_restr				= agr_in_restr_stalker_trader
anim					= hands_up
target					= actor
meet					= no_meet
on_info					= {=gulag_enemy_actor(agr_smart_terrain_4_4)} remark@enemy
on_info2				= {!is_smart_in_combat(agr_smart_terrain_4_4)} remark@wait
combat_ignore_cond			= true
combat_ignore_keep_when_attacked	= true

[remark@wait]
invulnerable				= true
path_walk				= agr_stalker_trader_walk
path_look				= agr_stalker_trader_look
out_restr				= agr_in_restr_stalker_trader
anim					= wait_trade
meet					= meet
combat_ignore_cond			= true
combat_ignore_keep_when_attacked	= true
on_info					= {=gulag_enemy_actor(agr_smart_terrain_4_4)} remark@enemy
on_info2				= {=is_smart_in_combat(agr_smart_terrain_4_4)} remark@invul_enemy
on_info3				= smartcover@near_table

[smartcover@near_table]
invulnerable				= true
cover_name				= agr_smart_cover_stalker_trader_1
loophole_name				= lead_stand_look_at_table
cover_state				= idle_target
combat_ignore_cond			= true
combat_ignore_keep_when_attacked	= true
out_restr				= agr_in_restr_stalker_trader
on_timer				= 13330 | smartcover@near_table2
def_state_moving			= walk
on_info					= {=gulag_enemy_actor(agr_smart_terrain_4_4)} remark@enemy
on_info2				= {=is_smart_in_combat(agr_smart_terrain_4_4)} remark@invul_enemy
on_info3				= {=actor_in_zone(agr_stalker_trader_tradezone)} smartcover@trade
meet					= meet

[smartcover@near_table2]
invulnerable				= true
cover_name				= agr_smart_cover_stalker_trader_1
loophole_name				= lead_stand_look_at_table
cover_state				= lookout_target
combat_ignore_cond			= true
combat_ignore_keep_when_attacked	= true
out_restr				= agr_in_restr_stalker_trader
on_timer				= 15000 | smartcover@near_table3
def_state_moving			= walk
on_info					= {=gulag_enemy_actor(agr_smart_terrain_4_4)} remark@enemy
on_info2				= {=is_smart_in_combat(agr_smart_terrain_4_4)} remark@invul_enemy
on_info3				= {=actor_in_zone(agr_stalker_trader_tradezone)} smartcover@trade
meet					= meet

[smartcover@near_table3]
invulnerable				= true
cover_name				= agr_smart_cover_stalker_trader_1
loophole_name				= lead_stand_look_at_table
cover_state				= fire_no_lookout_target
combat_ignore_cond			= true
combat_ignore_keep_when_attacked	= true
out_restr				= agr_in_restr_stalker_trader
on_timer				= 4500 | smartcover@near_table4
def_state_moving			= walk
on_info					= {=gulag_enemy_actor(agr_smart_terrain_4_4)} remark@enemy
on_info2				= {=is_smart_in_combat(agr_smart_terrain_4_4)} remark@invul_enemy
on_info3				= {=actor_in_zone(agr_stalker_trader_tradezone)} smartcover@trade
meet					= meet

[smartcover@near_table4]
invulnerable				= true
cover_name				= agr_smart_cover_stalker_trader_1
loophole_name				= lead_stand_look_at_table
cover_state				= fire_target
combat_ignore_cond			= true
combat_ignore_keep_when_attacked	= true
out_restr				= agr_in_restr_stalker_trader
on_timer				= 6500 | smartcover@near_table
def_state_moving			= walk
on_info					= {=gulag_enemy_actor(agr_smart_terrain_4_4)} remark@enemy
on_info2				= {=is_smart_in_combat(agr_smart_terrain_4_4)} remark@invul_enemy
on_info3				= {=actor_in_zone(agr_stalker_trader_tradezone)} smartcover@trade
meet					= meet

[smartcover@look_up]
invulnerable				= true
cover_name				= agr_smart_cover_stalker_trader_2
loophole_name				= lead_stand_look_down_2
cover_state				= lookout_target
combat_ignore_cond			= true
combat_ignore_keep_when_attacked	= true
out_restr				= agr_in_restr_stalker_trader
on_timer				= 15000 | smartcover@look_up2
def_state_moving			= walk
on_info					= {=gulag_enemy_actor(agr_smart_terrain_4_4)} remark@enemy
on_info2				= {=is_smart_in_combat(agr_smart_terrain_4_4)} remark@invul_enemy
on_info3				= {=actor_in_zone(agr_stalker_trader_tradezone)} smartcover@trade
meet					= meet

[smartcover@look_up2]
invulnerable				= true
cover_name				= agr_smart_cover_stalker_trader_2
loophole_name				= lead_stand_look_down_2
cover_state				= fire_no_lookout_target
combat_ignore_cond			= true
combat_ignore_keep_when_attacked	= true
out_restr				= agr_in_restr_stalker_trader
on_timer				= 15000 | smartcover@near_table
def_state_moving			= walk
on_info					= {=gulag_enemy_actor(agr_smart_terrain_4_4)} remark@enemy
on_info2				= {=is_smart_in_combat(agr_smart_terrain_4_4)} remark@invul_enemy
on_info3				= {=actor_in_zone(agr_stalker_trader_tradezone)} smartcover@trade
meet					= meet

[smartcover@trade]
invulnerable				= true
cover_name				= agr_smart_cover_stalker_trader_1
loophole_name				= lead_stand_look_at_table
cover_state				= idle_target
combat_ignore_cond			= true
combat_ignore_keep_when_attacked	= true
out_restr				= agr_in_restr_stalker_trader
def_state_moving			= walk
meet					= meet
on_info					= {=gulag_enemy_actor(agr_smart_terrain_4_4)} remark@enemy
on_info2				= {=is_smart_in_combat(agr_smart_terrain_4_4)} remark@invul_enemy
on_info3				= {!actor_in_zone(agr_stalker_trader_tradezone)} smartcover@near_table

[meet]
meet_state				= 0 | nil@nil
victim					= 0 | nil
use					= true
abuse					= false
